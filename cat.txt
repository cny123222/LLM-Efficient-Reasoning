--------------------------------------------------
A_window_512            13.47  47.85%      512.0
A_window_256            21.09  43.14%      256.0
A_window_128            26.28  40.94%      128.0
A_window_64             38.72  36.04%       64.0

--- B_streaming ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
B_streaming_512          8.81  52.45%      512.0
B_streaming_256          9.14  51.95%      256.0
B_streaming_128          9.52  52.05%      128.0
B_streaming_64          10.57  51.05%       64.0

--- C_head_aware_pos_mix_g512 ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
C_ha_pos8_mix32_g512    13.56  47.45%       68.2
C_ha_pos8_mix64_g512    12.16  48.95%       85.9
C_ha_pos8_mix128_g512    11.29  50.05%      121.3
C_ha_pos16_mix32_g512    12.64  48.15%       71.1
C_ha_pos16_mix64_g512    11.36  50.05%       88.8
C_ha_pos16_mix128_g512    10.63  51.25%      124.2
C_ha_pos32_mix32_g512    11.98  50.35%       76.9
C_ha_pos32_mix64_g512    10.70  50.65%       94.6
C_ha_pos32_mix128_g512    10.05  51.15%      130.0
C_ha_pos64_mix32_g512    11.29  50.55%       88.5
C_ha_pos64_mix64_g512    10.32  50.55%      106.2
C_ha_pos64_mix128_g512     9.75  52.35%      141.5

--- D_head_aware_pos_mix ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
D_ha_pos8_mix32         13.65  47.65%      112.2
D_ha_pos8_mix64         12.06  49.85%      129.9
D_ha_pos8_mix128        11.34  50.05%      165.3
D_ha_pos16_mix32        12.69  48.05%      115.1
D_ha_pos16_mix64        11.34  50.65%      132.8
D_ha_pos16_mix128       10.60  50.85%      168.2
D_ha_pos32_mix32        11.90  50.35%      120.9
D_ha_pos32_mix64        10.71  51.35%      138.6
D_ha_pos32_mix128       10.02  51.05%      174.0
D_ha_pos64_mix32        11.28  50.65%      132.5
D_ha_pos64_mix64        10.33  51.15%      150.2
D_ha_pos64_mix128        9.70  51.85%      185.5

--- E_head_aware_no_sink ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
E_ha_no_sink           151.69  24.42%      129.9

--- F_head_aware_default ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
F_ha_default            11.74  49.75%      130.0
F2_ha_default_g512      11.65  50.25%       86.0


--- G_confidence_based ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
G1_conf0.6_base128       9.57  51.85%      128.3
G2_conf0.5_base128      10.86  50.35%       74.1
G3_conf0.4_base64       11.56  49.75%       52.6
G4_conf0.6_base64       10.47  50.65%       66.1

--- H_inverse ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
H1_base64_g256          10.54  50.55%       71.0
H2_base64_g512          10.54  51.35%       84.6
H3_base128_g256          9.57  52.05%      134.0
H4_base128_g512          9.59  52.15%      146.2

======================================================================
KEY COMPARISONS
======================================================================

1. Window-only vs StreamingLLM (Effect of Sink Tokens):
   Window 512: PPL=13.47 vs Streaming 512: PPL=8.81 (+52.90%)
   Window 256: PPL=21.09 vs Streaming 256: PPL=9.14 (+130.68%)
   Window 128: PPL=26.28 vs Streaming 128: PPL=9.52 (+176.21%)

2. Head-Aware (gathering=512) vs StreamingLLM:
   C_ha_pos8_mix32_g512: PPL=13.56, Ctx=68
      vs B_streaming_64: PPL=10.57, Ctx=64 (+28.34%, streaming better)
   C_ha_pos16_mix32_g512: PPL=12.64, Ctx=71
      vs B_streaming_64: PPL=10.57, Ctx=64 (+19.58%, streaming better)
   C_ha_pos32_mix32_g512: PPL=11.98, Ctx=77
      vs B_streaming_64: PPL=10.57, Ctx=64 (+13.38%, streaming better)

3. Gathering Full vs Gathering=512 (Do gathering heads need full context?):
   pos=8, mix=32:
      g=512: PPL=13.56, Ctx=68
      g=full: PPL=13.65, Ctx=112
      PPL change: -0.62%, Context saved: 44
   pos=8, mix=64:
      g=512: PPL=12.16, Ctx=86
      g=full: PPL=12.06, Ctx=130
      PPL change: +0.88%, Context saved: 44
   pos=8, mix=128:
      g=512: PPL=11.29, Ctx=121
      g=full: PPL=11.34, Ctx=165
      PPL change: -0.44%, Context saved: 44
   pos=16, mix=32:
      g=512: PPL=12.64, Ctx=71
      g=full: PPL=12.69, Ctx=115
      PPL change: -0.41%, Context saved: 44

4. Positional Window Sensitivity (gathering=512, mixed=64):
   C_ha_pos8_mix64_g512: PPL=12.16, Ctx=86
   C_ha_pos16_mix64_g512: PPL=11.36, Ctx=89
   C_ha_pos32_mix64_g512: PPL=10.70, Ctx=95
   C_ha_pos64_mix64_g512: PPL=10.32, Ctx=106

5. Mixed Window Sensitivity (gathering=512, pos=16):
   C_ha_pos16_mix32_g512: PPL=12.64, Ctx=71
   C_ha_pos16_mix64_g512: PPL=11.36, Ctx=89
   C_ha_pos16_mix128_g512: PPL=10.63, Ctx=124

6. Effect of Sink Tokens (Head-Aware with vs without sink):
   With sink (4):    PPL=11.34, Ctx=133
   Without sink:     PPL=151.69, Ctx=130
   PPL change without sink: +1237.10%

7. Per-Head Recommended Windows (F group) vs Uniform Overrides:
   F_ha_default (per-head windows): PPL=11.74, Ctx=130
   vs Streaming 128: PPL=9.52 (+23.37%)
   F2_ha_default_g512 (gathering=512): PPL=11.65, Ctx=86
   PPL change: -0.80%, Context saved: 44

Results saved to: results/ablation_confidence_based.json

======================================================================
ABLATION STUDY COMPLETE
======================================================================