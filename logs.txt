(base) root@autodl-container-ff5d489b4f-b6933d5f:~/LLM-Efficient-Reasoning# HF_HUB_OFFLINE=1 python scripts/ablation_head_aware_mask.py     --model EleutherAI/pythia-2.8b     --classifications results/attention_analysis_pythia-2.8b/head_classifications.json     --max-tokens 2000     --output results/ablation_head_aware_mask.json
Loading model: EleutherAI/pythia-2.8b
`torch_dtype` is deprecated! Use `dtype` instead!

======================================================================
ABLATION STUDY: HEAD-AWARE ATTENTION MASK
======================================================================

======================================================================
GROUP: A_uniform
======================================================================

  Running: A_uniform_512...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=508):32
  Layer 1: uniform(w=508):32
  Layer 2: uniform(w=508):32
  Layer 3: uniform(w=508):32
  Layer 4: uniform(w=508):32
  ... (showing first 5 of 32 layers)

PPL: 8.98, Acc: 52.93%: 100%|████████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:53<00:00, 11.53it/s]
    PPL: 8.98, Acc: 52.93%, Eff.Ctx: 512.0

  Running: A_uniform_256...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=252):32
  Layer 1: uniform(w=252):32
  Layer 2: uniform(w=252):32
  Layer 3: uniform(w=252):32
  Layer 4: uniform(w=252):32
  ... (showing first 5 of 32 layers)

PPL: 9.48, Acc: 51.83%: 100%|████████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:52<00:00, 11.57it/s]
    PPL: 9.48, Acc: 51.83%, Eff.Ctx: 256.0

  Running: A_uniform_128...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=124):32
  Layer 1: uniform(w=124):32
  Layer 2: uniform(w=124):32
  Layer 3: uniform(w=124):32
  Layer 4: uniform(w=124):32
  ... (showing first 5 of 32 layers)

PPL: 9.89, Acc: 51.98%: 100%|████████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:53<00:00, 11.55it/s]
    PPL: 9.89, Acc: 51.98%, Eff.Ctx: 128.0

  Running: A_uniform_64...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=60):32
  Layer 1: uniform(w=60):32
  Layer 2: uniform(w=60):32
  Layer 3: uniform(w=60):32
  Layer 4: uniform(w=60):32
  ... (showing first 5 of 32 layers)

PPL: 10.97, Acc: 50.28%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:52<00:00, 11.57it/s]
    PPL: 10.97, Acc: 50.28%, Eff.Ctx: 64.0

  Running: A_uniform_32...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=28):32
  Layer 1: uniform(w=28):32
  Layer 2: uniform(w=28):32
  Layer 3: uniform(w=28):32
  Layer 4: uniform(w=28):32
  ... (showing first 5 of 32 layers)

PPL: 13.11, Acc: 48.12%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:53<00:00, 11.55it/s]
    PPL: 13.11, Acc: 48.12%, Eff.Ctx: 32.0

  Running: A_uniform_16...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=12):32
  Layer 1: uniform(w=12):32
  Layer 2: uniform(w=12):32
  Layer 3: uniform(w=12):32
  Layer 4: uniform(w=12):32
  ... (showing first 5 of 32 layers)

PPL: 23.05, Acc: 40.32%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:53<00:00, 11.50it/s]
    PPL: 23.05, Acc: 40.32%, Eff.Ctx: 16.0

======================================================================
GROUP: B_sink_only
======================================================================

  Running: B_sink_only_512...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=0):32
  Layer 1: uniform(w=0):32
  Layer 2: uniform(w=0):32
  Layer 3: uniform(w=0):32
  Layer 4: uniform(w=0):32
  ... (showing first 5 of 32 layers)

PPL: 123.80, Acc: 26.06%: 100%|██████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:53<00:00, 11.55it/s]
    PPL: 123.80, Acc: 26.06%, Eff.Ctx: 512.0

  Running: B_sink_only_256...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=0):32
  Layer 1: uniform(w=0):32
  Layer 2: uniform(w=0):32
  Layer 3: uniform(w=0):32
  Layer 4: uniform(w=0):32
  ... (showing first 5 of 32 layers)

PPL: 207.51, Acc: 20.46%: 100%|██████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:53<00:00, 11.54it/s]
    PPL: 207.51, Acc: 20.46%, Eff.Ctx: 256.0

  Running: B_sink_only_128...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=0):32
  Layer 1: uniform(w=0):32
  Layer 2: uniform(w=0):32
  Layer 3: uniform(w=0):32
  Layer 4: uniform(w=0):32
  ... (showing first 5 of 32 layers)

PPL: 407.12, Acc: 17.96%: 100%|██████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:53<00:00, 11.53it/s]
    PPL: 407.12, Acc: 17.96%, Eff.Ctx: 128.0

  Running: B_sink_only_64...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=0):32
  Layer 1: uniform(w=0):32
  Layer 2: uniform(w=0):32
  Layer 3: uniform(w=0):32
  Layer 4: uniform(w=0):32
  ... (showing first 5 of 32 layers)

PPL: 507.25, Acc: 15.71%: 100%|██████████████████████████████████████████████████████████████████████████████| 1999/1999 [04:16<00:00,  7.80it/s]
    PPL: 507.25, Acc: 15.71%, Eff.Ctx: 64.0

  Running: B_sink_only_32...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=0):32
  Layer 1: uniform(w=0):32
  Layer 2: uniform(w=0):32
  Layer 3: uniform(w=0):32
  Layer 4: uniform(w=0):32
  ... (showing first 5 of 32 layers)

PPL: 659.46, Acc: 13.46%: 100%|██████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:52<00:00, 11.57it/s]
    PPL: 659.46, Acc: 13.46%, Eff.Ctx: 32.0

  Running: B_sink_only_16...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: uniform(w=0):32
  Layer 1: uniform(w=0):32
  Layer 2: uniform(w=0):32
  Layer 3: uniform(w=0):32
  Layer 4: uniform(w=0):32
  ... (showing first 5 of 32 layers)

PPL: 829.85, Acc: 13.11%: 100%|██████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:52<00:00, 11.57it/s]
    PPL: 829.85, Acc: 13.11%, Eff.Ctx: 16.0

======================================================================
GROUP: C_head_aware_pos
======================================================================

  Running: C_ha_pos4...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=64):3
  Layer 1: gathering(w=-1):13, mixed(w=64):16, positional(w=4):3
  Layer 2: gathering(w=-1):24, mixed(w=64):8
  Layer 3: gathering(w=-1):2, mixed(w=64):17, positional(w=4):13
  Layer 4: gathering(w=-1):4, mixed(w=64):25, positional(w=4):3
  ... (showing first 5 of 32 layers)

PPL: 13.03, Acc: 46.92%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:54<00:00, 11.45it/s]
    PPL: 13.03, Acc: 46.92%, Eff.Ctx: 128.5

  Running: C_ha_pos8...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=64):3
  Layer 1: gathering(w=-1):13, mixed(w=64):16, positional(w=8):3
  Layer 2: gathering(w=-1):24, mixed(w=64):8
  Layer 3: gathering(w=-1):2, mixed(w=64):17, positional(w=8):13
  Layer 4: gathering(w=-1):4, mixed(w=64):25, positional(w=8):3
  ... (showing first 5 of 32 layers)

PPL: 12.05, Acc: 49.47%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:45<00:00, 12.10it/s]
    PPL: 12.05, Acc: 49.47%, Eff.Ctx: 129.9

  Running: C_ha_pos16...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=64):3
  Layer 1: gathering(w=-1):13, mixed(w=64):16, positional(w=16):3
  Layer 2: gathering(w=-1):24, mixed(w=64):8
  Layer 3: gathering(w=-1):2, mixed(w=64):17, positional(w=16):13
  Layer 4: gathering(w=-1):4, mixed(w=64):25, positional(w=16):3
  ... (showing first 5 of 32 layers)

PPL: 11.38, Acc: 50.38%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:44<00:00, 12.15it/s]
    PPL: 11.38, Acc: 50.38%, Eff.Ctx: 132.8

  Running: C_ha_pos32...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=64):3
  Layer 1: gathering(w=-1):13, mixed(w=64):16, positional(w=32):3
  Layer 2: gathering(w=-1):24, mixed(w=64):8
  Layer 3: gathering(w=-1):2, mixed(w=64):17, positional(w=32):13
  Layer 4: gathering(w=-1):4, mixed(w=64):25, positional(w=32):3
  ... (showing first 5 of 32 layers)

PPL: 10.83, Acc: 51.38%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:44<00:00, 12.15it/s]
    PPL: 10.83, Acc: 51.38%, Eff.Ctx: 138.6

  Running: C_ha_pos64...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=64):3
  Layer 1: gathering(w=-1):13, mixed(w=64):16, positional(w=64):3
  Layer 2: gathering(w=-1):24, mixed(w=64):8
  Layer 3: gathering(w=-1):2, mixed(w=64):17, positional(w=64):13
  Layer 4: gathering(w=-1):4, mixed(w=64):25, positional(w=64):3
  ... (showing first 5 of 32 layers)

PPL: 10.67, Acc: 50.48%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:44<00:00, 12.14it/s]
    PPL: 10.67, Acc: 50.48%, Eff.Ctx: 150.2

======================================================================
GROUP: D_head_aware_mix
======================================================================

  Running: D_ha_mix32...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=32):3
  Layer 1: gathering(w=-1):13, mixed(w=32):16, positional(w=8):3
  Layer 2: gathering(w=-1):24, mixed(w=32):8
  Layer 3: gathering(w=-1):2, mixed(w=32):17, positional(w=8):13
  Layer 4: gathering(w=-1):4, mixed(w=32):25, positional(w=8):3
  ... (showing first 5 of 32 layers)

PPL: 13.50, Acc: 47.22%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:44<00:00, 12.12it/s]
    PPL: 13.50, Acc: 47.22%, Eff.Ctx: 112.2

  Running: D_ha_mix64...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=64):3
  Layer 1: gathering(w=-1):13, mixed(w=64):16, positional(w=8):3
  Layer 2: gathering(w=-1):24, mixed(w=64):8
  Layer 3: gathering(w=-1):2, mixed(w=64):17, positional(w=8):13
  Layer 4: gathering(w=-1):4, mixed(w=64):25, positional(w=8):3
  ... (showing first 5 of 32 layers)

PPL: 12.05, Acc: 49.47%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:45<00:00, 12.08it/s]
    PPL: 12.05, Acc: 49.47%, Eff.Ctx: 129.9

  Running: D_ha_mix128...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=128):3
  Layer 1: gathering(w=-1):13, mixed(w=128):16, positional(w=8):3
  Layer 2: gathering(w=-1):24, mixed(w=128):8
  Layer 3: gathering(w=-1):2, mixed(w=128):17, positional(w=8):13
  Layer 4: gathering(w=-1):4, mixed(w=128):25, positional(w=8):3
  ... (showing first 5 of 32 layers)

PPL: 11.41, Acc: 49.57%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:45<00:00, 12.11it/s]
    PPL: 11.41, Acc: 49.57%, Eff.Ctx: 165.3

  Running: D_ha_mix256...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=256):3
  Layer 1: gathering(w=-1):13, mixed(w=256):16, positional(w=8):3
  Layer 2: gathering(w=-1):24, mixed(w=256):8
  Layer 3: gathering(w=-1):2, mixed(w=256):17, positional(w=8):13
  Layer 4: gathering(w=-1):4, mixed(w=256):25, positional(w=8):3
  ... (showing first 5 of 32 layers)

PPL: 11.08, Acc: 49.22%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:44<00:00, 12.16it/s]
    PPL: 11.08, Acc: 49.22%, Eff.Ctx: 236.0

======================================================================
GROUP: E_head_aware_no_sink
======================================================================

  Running: E_ha_no_sink...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=68):3
  Layer 1: gathering(w=-1):13, mixed(w=68):16, positional(w=12):3
  Layer 2: gathering(w=-1):24, mixed(w=68):8
  Layer 3: gathering(w=-1):2, mixed(w=68):17, positional(w=12):13
  Layer 4: gathering(w=-1):4, mixed(w=68):25, positional(w=12):3
  ... (showing first 5 of 32 layers)

PPL: 139.84, Acc: 25.46%: 100%|██████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:44<00:00, 12.15it/s]
    PPL: 139.84, Acc: 25.46%, Eff.Ctx: 129.9

======================================================================
GROUP: F_head_aware_default
======================================================================

  Running: F_ha_default...
Evaluating (head-aware mask):   0%|                                                                                     | 0/1999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=-1):29, mixed(w=64):3
  Layer 1: gathering(w=-1):13, mixed(w=64):16, positional(w=8):3
  Layer 2: gathering(w=-1):24, mixed(w=64):8
  Layer 3: gathering(w=-1):2, mixed(w=64):17, positional(w=16):1, positional(w=8):12
  Layer 4: gathering(w=-1):4, mixed(w=64):25, positional(w=8):3
  ... (showing first 5 of 32 layers)

PPL: 11.69, Acc: 49.77%: 100%|███████████████████████████████████████████████████████████████████████████████| 1999/1999 [02:44<00:00, 12.15it/s]
    PPL: 11.69, Acc: 49.77%, Eff.Ctx: 130.0

======================================================================
ABLATION RESULTS SUMMARY (by group)
======================================================================

--- A_uniform ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
A_uniform_512            8.98  52.93%      512.0
A_uniform_256            9.48  51.83%      256.0
A_uniform_128            9.89  51.98%      128.0
A_uniform_64            10.97  50.28%       64.0
A_uniform_32            13.11  48.12%       32.0
A_uniform_16            23.05  40.32%       16.0

--- B_sink_only ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
B_sink_only_512        123.80  26.06%      512.0
B_sink_only_256        207.51  20.46%      256.0
B_sink_only_128        407.12  17.96%      128.0
B_sink_only_64         507.25  15.71%       64.0
B_sink_only_32         659.46  13.46%       32.0
B_sink_only_16         829.85  13.11%       16.0

--- C_head_aware_pos ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
C_ha_pos4               13.03  46.92%      128.5
C_ha_pos8               12.05  49.47%      129.9
C_ha_pos16              11.38  50.38%      132.8
C_ha_pos32              10.83  51.38%      138.6  * 
C_ha_pos64              10.67  50.48%      150.2

--- D_head_aware_mix ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
D_ha_mix32              13.50  47.22%      112.2
D_ha_mix64              12.05  49.47%      129.9
D_ha_mix128             11.41  49.57%      165.3
D_ha_mix256             11.08  49.22%      236.0

--- E_head_aware_no_sink ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
E_ha_no_sink           139.84  25.46%      129.9

--- F_head_aware_default ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
F_ha_default            11.69  49.77%      130.0

======================================================================
KEY COMPARISONS
======================================================================

1. Head-Aware vs Uniform (similar effective context):
   Head-Aware Default: PPL=11.69, Ctx=130
   Closest Uniform:    PPL=9.89, Ctx=128
   PPL difference: +18.24% (uniform better)

2. Head-Aware (pos=4) vs Sink-Only 128:
   Head-Aware pos4: PPL=13.03, Ctx=128
   Sink-Only 128:   PPL=407.12, Ctx=128
   PPL difference: -96.80%

3. Effect of Sink Tokens (Head-Aware with vs without sink):
   With sink (4):    PPL=11.69
   Without sink:     PPL=139.84
   PPL degradation without sink: +1096.06%

4. Positional Window Sensitivity:
   C_ha_pos4: PPL=13.03, Ctx=128
   C_ha_pos8: PPL=12.05, Ctx=130
   C_ha_pos16: PPL=11.38, Ctx=133
   C_ha_pos32: PPL=10.83, Ctx=139
   C_ha_pos64: PPL=10.67, Ctx=150

Results saved to: results/ablation_head_aware_mask.json




======================================================================
GROUP: C_head_aware_pos_mix_g
======================================================================

  Running: C_ha_pos32_mix32_g508...
Evaluating (head-aware mask):   0%|                                                                                      | 0/999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=508):29, mixed(w=32):3
  Layer 1: gathering(w=508):13, mixed(w=32):16, positional(w=32):3
  Layer 2: gathering(w=508):24, mixed(w=32):8
  Layer 3: gathering(w=508):2, mixed(w=32):17, positional(w=32):13
  Layer 4: gathering(w=508):4, mixed(w=32):25, positional(w=32):3
  ... (showing first 5 of 32 layers)

PPL: 11.98, Acc: 50.35%: 100%|█████████████████████████████████████████████████████████████████████████████████| 999/999 [01:25<00:00, 11.64it/s]
    PPL: 11.98, Acc: 50.35%, Eff.Ctx: 76.9

  Running: C_ha_pos32_mix32_g252...
Evaluating (head-aware mask):   0%|                                                                                      | 0/999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=252):29, mixed(w=32):3
  Layer 1: gathering(w=252):13, mixed(w=32):16, positional(w=32):3
  Layer 2: gathering(w=252):24, mixed(w=32):8
  Layer 3: gathering(w=252):2, mixed(w=32):17, positional(w=32):13
  Layer 4: gathering(w=252):4, mixed(w=32):25, positional(w=32):3
  ... (showing first 5 of 32 layers)

PPL: 11.93, Acc: 50.25%: 100%|█████████████████████████████████████████████████████████████████████████████████| 999/999 [01:25<00:00, 11.74it/s]
    PPL: 11.93, Acc: 50.25%, Eff.Ctx: 54.9

  Running: C_ha_pos32_mix32_g124...
Evaluating (head-aware mask):   0%|                                                                                      | 0/999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=124):29, mixed(w=32):3
  Layer 1: gathering(w=124):13, mixed(w=32):16, positional(w=32):3
  Layer 2: gathering(w=124):24, mixed(w=32):8
  Layer 3: gathering(w=124):2, mixed(w=32):17, positional(w=32):13
  Layer 4: gathering(w=124):4, mixed(w=32):25, positional(w=32):3
  ... (showing first 5 of 32 layers)

PPL: 11.97, Acc: 50.15%: 100%|█████████████████████████████████████████████████████████████████████████████████| 999/999 [01:24<00:00, 11.78it/s]
    PPL: 11.97, Acc: 50.15%, Eff.Ctx: 43.9

  Running: C_ha_pos32_mix32_g60...
Evaluating (head-aware mask):   0%|                                                                                      | 0/999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=60):29, mixed(w=32):3
  Layer 1: gathering(w=60):13, mixed(w=32):16, positional(w=32):3
  Layer 2: gathering(w=60):24, mixed(w=32):8
  Layer 3: gathering(w=60):2, mixed(w=32):17, positional(w=32):13
  Layer 4: gathering(w=60):4, mixed(w=32):25, positional(w=32):3
  ... (showing first 5 of 32 layers)

PPL: 12.05, Acc: 50.45%: 100%|█████████████████████████████████████████████████████████████████████████████████| 999/999 [01:24<00:00, 11.78it/s]
    PPL: 12.05, Acc: 50.45%, Eff.Ctx: 38.4

  Running: C_ha_pos32_mix64_g508...
Evaluating (head-aware mask):   0%|                                                                                      | 0/999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=508):29, mixed(w=64):3
  Layer 1: gathering(w=508):13, mixed(w=64):16, positional(w=32):3
  Layer 2: gathering(w=508):24, mixed(w=64):8
  Layer 3: gathering(w=508):2, mixed(w=64):17, positional(w=32):13
  Layer 4: gathering(w=508):4, mixed(w=64):25, positional(w=32):3
  ... (showing first 5 of 32 layers)

PPL: 10.70, Acc: 50.65%: 100%|█████████████████████████████████████████████████████████████████████████████████| 999/999 [01:24<00:00, 11.79it/s]
    PPL: 10.70, Acc: 50.65%, Eff.Ctx: 94.6

  Running: C_ha_pos32_mix64_g252...
Evaluating (head-aware mask):   0%|                                                                                      | 0/999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=252):29, mixed(w=64):3
  Layer 1: gathering(w=252):13, mixed(w=64):16, positional(w=32):3
  Layer 2: gathering(w=252):24, mixed(w=64):8
  Layer 3: gathering(w=252):2, mixed(w=64):17, positional(w=32):13
  Layer 4: gathering(w=252):4, mixed(w=64):25, positional(w=32):3
  ... (showing first 5 of 32 layers)

PPL: 10.66, Acc: 51.45%: 100%|█████████████████████████████████████████████████████████████████████████████████| 999/999 [01:43<00:00,  9.63it/s]
    PPL: 10.66, Acc: 51.45%, Eff.Ctx: 72.6

  Running: C_ha_pos32_mix64_g124...
Evaluating (head-aware mask):   0%|                                                                                      | 0/999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=124):29, mixed(w=64):3
  Layer 1: gathering(w=124):13, mixed(w=64):16, positional(w=32):3
  Layer 2: gathering(w=124):24, mixed(w=64):8
  Layer 3: gathering(w=124):2, mixed(w=64):17, positional(w=32):13
  Layer 4: gathering(w=124):4, mixed(w=64):25, positional(w=32):3
  ... (showing first 5 of 32 layers)

PPL: 10.69, Acc: 51.65%: 100%|█████████████████████████████████████████████████████████████████████████████████| 999/999 [01:36<00:00, 10.37it/s]
    PPL: 10.69, Acc: 51.65%, Eff.Ctx: 61.6

  Running: C_ha_pos32_mix64_g60...
Evaluating (head-aware mask):   0%|                                                                                      | 0/999 [00:00<?, ?it/s][PerLayerMaskInjector] Registered 32 hooks

[Per-Layer Mask Config] Head type distribution per layer:
  Layer 0: gathering(w=60):29, mixed(w=64):3
  Layer 1: gathering(w=60):13, mixed(w=64):16, positional(w=32):3
  Layer 2: gathering(w=60):24, mixed(w=64):8
  Layer 3: gathering(w=60):2, mixed(w=64):17, positional(w=32):13
  Layer 4: gathering(w=60):4, mixed(w=64):25, positional(w=32):3
  ... (showing first 5 of 32 layers)

PPL: 8.27, Acc: 55.56%:  14%|███████████▋                                                     PPL: 8.27, Acc: 55.56%:  14%|███████████▊                                                     PPL: 8.18, Acc: 55.86%:  14%|███████████▊                                                     PPL: 8.34, Acc: 55.48%:  14%|███████████▊                                                     PPL: 8.34, Acc: 55.48%:  15%|███████████▉                                                     PPL: 8.34, Acc: 55.10%:  15%|███████████▉                                                     PPL: 8.50, Acc: 54.73%:  15%|███████████▉                                                     PPL: 8.50, Acc: 54.73%:  15%|████████████▏                                                    PPL: 8.43, Acc: 55.03%:  15%|████████████▏                                                    PPL: 8.47, Acc: 55.33%:  15%|████████████▏                                                    PPL: 8.47, Acc: 55.33%:  15%|████████████▎                                                    PPL: 8.63, Acc: 54.97%:  15%|████████████▎                                                    PPL: 8.54, Acc: 55.26%:  15%|████████████▎                                                    PPL: 8.54, Acc: 55.26%:  15%|████████████▍                                                    PPL: 8.42, Acc: 55.56%:  15%|████████████▍                                                    PPL: 8.72, Acc: 55.19%:  15%|████████████▍                                                    PPL: 8.72, Acc: 55.19%:  15%|████████████▋                                                    PPL: 8.84, Acc: 54.84%:  15%|████████████▋                                                    PPL: 8.78, Acc: 55.13%:  15%|████████████▋                                                    PPL: 8.78, Acc: 55.13%:  16%|████████████▊                                                    PPL: 8.68, Acc: 55.41%:  16%|████████████▊                                                    PPL: 8.85, Acc: 55.06%:  16%|████████████▊                                                    PPL: 8.85, Acc: 55.06%:  16%|████████████▉                                                    PPL: 8.73, Acc: 55.35%:  16%|████████████▉                                                    PPL: 8.64, Acc: 55.62%:  16%|████████████▉                                                    PPL: 8.64, Acc: 55.62%:  16%|█████████████▏                                                   PPL: 8.75, Acc: 55.28%:  16%|█████████████▏                                                   PPL: 8.65, Acc: 55.56%:  16%|█████████████▏                                                   PPL: 8.65, Acc: 55.56%:  16%|█████████████▎                                                   PPL: 8.82, Acc: 55.21%:  16%|█████████████▎                                                   PPL: 8.79, Acc: 55.49%:  16%|█████████████▎                                                   PPL: 8.79, Acc: 55.49%:  16%|█████████████▍                                                   PPL: 9.21, Acc: 55.15%:  16%|█████████████▍                                                   PPL: 9.09, Acc: 55.42%:  16%|█████████████▍                                                   PPL: 9.09, Acc: 55.42%:  17%|█████████████▋                                                   PPL: 9.32, Acc: 55.09%:  17%|█████████████▋                                                   PPL: 9.37, Acc: 54.76%:  17%|█████████████▋                                                   PPL: 9.37, Acc: 54.76%:  17%|█████████████▊                                                   PPL: 9.38, Acc: 54.44%:  17%|█████████████▊                                                   PPL: 9.26, Acc: 54.71%:  17%|█████████████▊                                                   PPL: 9.26, Acc: 54.71%:  17%|█████████████▉                                                   PPL: 9.15, Acc: 54.97%:  17%|█████████████▉                                                   PPL: 9.07, Acc: 55.23%:  17%|█████████████▉                                                   PPL: 9.07, Acc: 55.23%:  17%|██████████████                                                   PPL: 9.00, Acc: 55.49%:  17%|██████████████                                                   PPL: 9.28, Acc: 55.17%:  17%|██████████████                                                   PPL: 9.28, Acc: 55.17%:  17%|██████████████▎                                                  PPL: 9.18, Acc: 55.43%:  17%|██████████████▎                                                  PPL: 9.27, Acc: 55.11%:  17%|██████████████▎                                                  PPL: 9.27, Acc: 55.11%:  18%|██████████████▍                                                  PPL: 9.28, Acc: 54.80%:  18%|██████████████▍                                                  PPL: 9.22, Acc: 54.49%:  18%|██████████████▍                                                  PPL: 9.22, Acc: 54.49%:  18%|██████████████▌                                                  PPL: 9.30, Acc: 54.19%:  18%|██████████████▌                                                  PPL: 9.30, Acc: 53.89%:  18%|██████████████▌                                                  PPL: 9.30, Acc: 53.89%:  18%|██████████████▊                                                  PPL: 9.21, Acc: 54.14%:  18%|██████████████▊                                                  PPL: 9.32, Acc: 53.85%:  18%|██████████████▊                                                  PPL: 9.32, Acc: 53.85%:  18%|██████████████▉                                                  PPL: 9.26, Acc: 53.55%:  18%|██████████████▉                                                  PPL: 9.15, Acc: 53.80%:  18%|██████████████▉                                                  PPL: 9.15, Acc: 53.80%:  18%|███████████████                                                  PPL: 9.04, Acc: 54.05%:  18%|███████████████                                                  PPL: 9.07, Acc: 53.76%:  18%|███████████████                                                  PPL: 9.07, Acc: 53.76%:  19%|███████████████▎                                                 PPL: 8.98, Acc: 54.01%:  19%|███████████████▎                                                 PPL: 8.89, Acc: 54.26%:  19%|███████████████▎                                                 PPL: 8.89, Acc: 54.26%:  19%|███████████████▍                                                 PPL: 9.08, Acc: 53.97%:  19%|███████████████▍                                                 PPL: 9.00, Acc: 54.21%:  19%|███████████████▍                                                 PPL: 9.00, Acc: 54.21%:  19%|███████████████▌                                                 PPL: 9.04, Acc: 53.93%:  19%|███████████████▌                                                 PPL: 9.14, Acc: 53.65%:  19%|███████████████▌                                                 PPL: 9.14, Acc: 53.65%:  19%|███████████████▊                                                 PPL: 9.13, Acc: 53.37%:  19%|███████████████▊                                                 PPL: 9.23, Acc: 53.09%:  19%|███████████████▊                                                 PPL: 9.23, Acc: 53.09%:  19%|███████████████▉                                                 PPL: 9.13, Acc: 53.33%:  19%|███████████████▉                                                 PPL: 9.10, Acc: 53.06%:  19%|███████████████▉                                                 PPL: 9.10, Acc: 53.06%:  20%|████████████████                                                 PPL: 9.01, Acc: 53.30%:  20%|████████████████                                                 PPL: 8.92, Acc: 53.54%:  20%|████████████████                                                 PPL: 8.92, Acc: 53.54%:  20%|████████████████▎                                                PPL: 9.02, Acc: 53.27%:  20%|████████████████▎                                                PPL: 9.11, Acc: 53.00%:  20%|████████████████▎                                                PPL: 9.11, Acc: 53.00%:  20%|████████████████▍                                                PPL: 9.09, Acc: 53.23%:  20%|████████████████▍                                                PPL: 9.09, Acc: 52.97%:  20%|████████████████▍                                                PPL: 9.09, Acc: 52.97%:  20%|████████████████▌                                                PPL: 9.02, Acc: 53.20%:  20%|████████████████▌                                                PPL: 8.93, Acc: 53.43%:  20%|████████████████▌                                                PPL: 8.93, Acc: 53.43%:  20%|████████████████▋                                                PPL: 8.84, Acc: 53.66%:  20%|████████████████▋                                                PPL: 9.18, Acc: 53.40%:  20%|████████████████▋                                                PPL: 9.18, Acc: 53.40%:  21%|████████████████▉                                                PPL: 9.14, Acc: 53.14%:  21%|████████████████▉                                                PPL: 9.65, Acc: 52.88%:  21%|████████████████▉                                                PPL: 9.65, Acc: 52.88%:  21%|█████████████████                                                PPL: 9.62, Acc: 53.11%:  21%|█████████████████                                                PPL: 9.64, Acc: 52.86%:  21%|█████████████████                                                PPL: 9.64, Acc: 52.86%:  21%|█████████████████▏                                               PPL: 9.58, Acc: 53.08%:  21%|█████████████████▏                                               PPL: 9.51, Acc: 53.30%:  21%|█████████████████▏                                               PPL: 9.51, Acc: 53.30%:  21%|█████████████████▍                                               PPL: 9.67, Acc: 53.05%:  21%|█████████████████▍                                               PPL: 9.57, Acc: 53.27%:  21%|█████████████████▍                                               PPL: 9.57, Acc: 53.27%:  21%|█████████████████▌                                               PPL: 9.47, Acc: 53.49%:  21%|█████████████████▌                                               PPL: 9.45, Acc: 53.70%:  21%|█████████████████▌                                               PPL: 9.45, Acc: 53.70%:  22%|█████████████████▋                                               PPL: 9.73, Acc: 53.46%:  22%|█████████████████▋                                               PPL: 9.64, Acc: 53.67%:  22%|█████████████████▋                                               PPL: 9.64, Acc: 53.67%:  22%|█████████████████▉                                               PPL: 9.54, Acc: 53.88%:  22%|█████████████████▉                                               PPL: 9.53, Acc: 53.64%:  22%|█████████████████▉                                               PPL: 9.53, Acc: 53.64%:  22%|██████████████████                                               PPL: 9.56, Acc: 53.39%:  22%|██████████████████                                               PPL: 9.46, Acc: 53.60%:  22%|██████████████████                                               PPL: 9.46, Acc: 53.60%:  22%|██████████████████▏                                              PPL: 9.41, Acc: 53.36%:  22%|██████████████████▏                                              PPL: 9.49, Acc: 53.12%:  22%|██████████████████▏                                              PPL: 9.49, Acc: 53.12%:  22%|██████████████████▍                                              PPL: 9.40, Acc: 53.33%:  22%|██████████████████▍                                              PPL: 9.32, Acc: 53.54%:  22%|██████████████████▍                                              PPL: 9.32, Acc: 53.54%:  23%|██████████████████▌                                              PPL: 9.31, Acc: 53.30%:  23%|██████████████████▌                                              PPL: 9.23, Acc: 53.51%:  23%|██████████████████▌                                              PPL: 9.23, Acc: 53.51%:  23%|██████████████████▋                                              PPL: 9.26, Acc: 53.28%:  23%|██████████████████▋                                              PPL: 9.22, Acc: 53.04%:  23%|██████████████████▋                                              PPL: 9.22, Acc: 53.04%:  23%|██████████████████▉                                              PPL: 9.21, Acc: 52.81%:  23%|██████████████████▉                                              PPL: 9.45, Acc: 52.59%:  23%|██████████████████▉                                              PPL: 9.45, Acc: 52.59%:  23%|███████████████████                                              PPL: 9.38, Acc: 52.79%:  23%|███████████████████                                              PPL: 9.31, Acc: 52.99%:  23%|███████████████████                                              PPL: 9.31, Acc: 52.99%:  23%|███████████████████▏                                             PPL: 9.22, Acc: 53.19%:  23%|███████████████████▏                                             PPL: 9.23, Acc: 52.97%:  23%|███████████████████▏                                             PPL: 9.23, Acc: 52.97%:  24%|███████████████████▎                                             PPL: 9.17, Acc: 53.16%:  24%|███████████████████▎                                             PPL: 9.33, Acc: 52.94%:  24%|███████████████████▎                                             PPL: 9.33, Acc: 52.94%:  24%|███████████████████▌                                             PPL: 9.24, Acc: 53.14%:  24%|███████████████████▌                                             PPL: 9.22, Acc: 52.92%:  24%|███████████████████▌                                             PPL: 9.22, Acc: 52.92%:  24%|███████████████████▋                                             PPL: 9.14, Acc: 53.11%:  24%|███████████████████▋                                             PPL: 9.15, Acc: 52.89%:  24%|███████████████████▋                                             PPL: 9.15, Acc: 52.89%:  24%|███████████████████▊                                             PPL: 9.10, Acc: 52.67%:  24%|███████████████████▊                                             PPL: 9.02, Acc: 52.87%:  24%|███████████████████▊                                             PPL: 9.02, Acc: 52.87%:  24%|████████████████████                                             PPL: 9.12, Acc: 52.65%:  24%|████████████████████                                             PPL: 9.28, Acc: 52.44%:  24%|████████████████████                                             PPL: 9.28, Acc: 52.44%:  25%|████████████████████▏                                            PPL: 9.21, Acc: 52.63%:  25%|████████████████████▏                                            PPL: 9.13, Acc: 52.82%:  25%|████████████████████▏                                            PPL: 9.13, Acc: 52.82%:  25%|████████████████████▎                                            PPL: 9.18, Acc: 52.61%:  25%|████████████████████▎                                            PPL: 9.17, Acc: 52.40%:  25%|████████████████████▎                                            PPL: 9.17, Acc: 52.40%:  25%|████████████████████▌                                            PPL: 9.09, Acc: 52.59%:  25%|████████████████████▌                                            PPL: 9.01, Acc: 52.78%:  25%|████████████████████▌                                            PPL: 9.01, Acc: 52.78%:  25%|████████████████████▋                                            PPL: 9.27, Acc: 52.57%:  25%|████████████████████▋                                            PPL: 9.20, Acc: 52.76%:  25%|████████████████████▋                                            PPL: 9.20, Acc: 52.76%:  25%|████████████████████▊                                            PPL: 9.15, Acc: 52.94%:  25%|████████████████████▊                                            PPL: 9.16, Acc: 52.73%:  25%|████████████████████▊                                            PPL: 9.16, Acc: 52.73%:  26%|█████████████████████                                            PPL: 9.11, Acc: 52.92%:  26%|█████████████████████                                            PPL: 9.06, Acc: 53.10%:  26%|█████████████████████                                            PPL: 9.06, Acc: 53.10%:  26%|█████████████████████▏                                           PPL: 8.99, Acc: 53.28%:  26%|█████████████████████▏                                           PPL: 8.93, Acc: 53.46%:  26%|█████████████████████▏                                           PPL: 8.93, Acc: 53.46%:  26%|█████████████████████▎                                           PPL: 8.88, Acc: 53.64%:  26%|█████████████████████▎                                           PPL: 8.91, Acc: 53.44%:  26%|█████████████████████▎                                           PPL: 8.91, Acc: 53.44%:  26%|█████████████████████▌                                           PPL: 8.86, Acc: 53.61%:  26%|█████████████████████▌                                           PPL: 8.97, Acc: 53.41%:  26%|█████████████████████▌                                           PPL: 8.97, Acc: 53.41%:  26%|█████████████████████▋                                           PPL: 8.95, Acc: 53.21%:  26%|█████████████████████▋                                           PPL: 8.89, Acc: 53.38%:  26%|█████████████████████▋                                           PPL: 8.89, Acc: 53.38%:  27%|█████████████████████▊                                           PPL: 9.11, Acc: 53.18%:  27%|█████████████████████▊                                           PPL: 9.12, Acc: 53.36%:  27%|█████████████████████▊                                           PPL: 9.12, Acc: 53.36%:  27%|█████████████████████▉                                           PPL: 9.16, Acc: 53.16%:  27%|█████████████████████▉                                           PPL: 9.11, Acc: 53.33%:  27%|█████████████████████▉                                           PPL: 9.11, Acc: 53.33%:  27%|██████████████████████▏                                          PPL: 9.04, Acc: 53.51%:  27%|██████████████████████▏                                          PPL: 8.97, Acc: 53.68%:  27%|██████████████████████▏                                          PPL: 8.97, Acc: 53.68%:  27%|██████████████████████▎                                          PPL: 8.93, Acc: 53.48%:  27%|██████████████████████▎                                          PPL: 8.88, Acc: 53.65%:  27%|██████████████████████▎                                          PPL: 8.88, Acc: 53.65%:  27%|██████████████████████▍                                          PPL: 8.81, Acc: 53.82%:  27%|██████████████████████▍                                          PPL: 8.81, Acc: 53.82%:  27%|██████████████████████▍                                          PPL: 8.75, Acc: 53.99%:  27%|██████████████████████▍                                          PPL: 8.75, Acc: 53.99%:  28%|█████████████████████▌                                           PPL: 8.68, Acc: 54.15%:  28%|█████████████████████▌                                           PPL: 8.69, Acc: 53.96%:  28%|█████████████████████▌                                           PPL: 8.69, Acc: 53.96%:  28%|█████████████████████▋                                           PPL: 8.64, Acc: 54.12%:  28%|█████████████████████▋                                           PPL: 8.62, Acc: 54.29%:  28%|█████████████████████▋                                           PPL: 8.62, Acc: 54.29%:  28%|█████████████████████▊                                           PPL: 8.84, Acc: 54.09%:  28%|█████████████████████▊                                           PPL: 8.77, Acc: 54.26%:  28%|█████████████████████▊                                           PPL: 8.77, Acc: 54.26%:  28%|██████████████████████                                           PPL: 8.74, Acc: 54.42%:  28%|██████████████████████                                           PPL: 8.71, Acc: 54.58%:  28%|██████████████████████                                           PPL: 8.71, Acc: 54.58%:  28%|██████████████████████▍                                          PPL: 8.85, Acc: 54.39%:  28%|██████████████████████▍                                          PPL: 8.86, Acc: 54.20%:  28%|██████████████████████▍                                          PPL: 8.86, Acc: 54.20%:  29%|██████████████████████▌                                          PPL: 8.92, Acc: 54.01%:  29%|██████████████████████▌                                          PPL: 8.85, Acc: 54.17%:  29%|██████████████████████▌                                          PPL: 8.85, Acc: 54.17%:  29%|███████████████████████                                          PPL: 8.88, Acc: 53.98%:  29%|███████████████████████                                          PPL: 8.83, Acc: 54.14%:  29%|███████████████████████                                          PPL: 8.83, Acc: 54.14%:  29%|███████████████████████▏                                         PPL: 8.78, Acc: 54.30%:  29%|███████████████████████▏                                         PPL: 8.73, Acc: 54.45%:  29%|███████████████████████▏                                         PPL: 8.73, Acc: 54.45%:  29%|███████████████████████▍                                         PPL: 8.75, Acc: 54.27%:  29%|███████████████████████▍                                         PPL: 8.73, Acc: 54.08%:  29%|███████████████████████▍                                         PPL: 8.73, Acc: 54.08%:  29%|███████████████████████▌                                         PPL: 8.68, Acc: 54.24%:  29%|███████████████████████▌                                         PPL: 8.87, Acc: 54.05%:  29%|███████████████████████▌                                         PPL: 8.87, Acc: 54.05%:  30%|███████████████████████▋                                         PPL: 8.82, Acc: 54.21%:  30%|███████████████████████▋                                         PPL: 8.81, Acc: 54.03%:  30%|███████████████████████▋                                         PPL: 8.81, Acc: 54.03%:  30%|███████████████████████▊                                         PPL: 8.76, Acc: 54.18%:  30%|███████████████████████▊                                         PPL: 8.76, Acc: 54.00%:  30%|███████████████████████▊                                         PPL: 8.76, Acc: 54.00%:  30%|████████████████████████                                         PPL: 8.73, Acc: 54.15%:  30%|████████████████████████                                         PPL: 8.92, Acc: 53.97%:  30%|████████████████████████                                         PPL: 8.92, Acc: 53.97%:  30%|████████████████████████▊                                        PPL: 8.87, Acc: 54.13%:  30%|████████████████████████▊                                        PPL: 9.01, Acc: 53.95%:  30%|████████████████████████▊                                        PPL: 9.01, Acc: 53.95%:  30%|████████████████████████▉                                        PPL: 9.05, Acc: 53.77%:  30%|████████████████████████▉                                        PPL: 9.05, Acc: 53.59%:  30%|████████████████████████▉                                        PPL: 9.05, Acc: 53.59%:  31%|█████████████████████████                                        PPL: 9.15, Acc: 53.42%:  31%|█████████████████████████                                        PPL: 9.39, Acc: 53.25%:  31%|█████████████████████████                                        PPL: 9.39, Acc: 53.25%:  31%|█████████████████████████▎                                       PPL: 9.32, Acc: 53.40%:  31%|█████████████████████████▎                                       PPL: 9.49, Acc: 53.23%:  31%|█████████████████████████▎                                       PPL: 9.49, Acc: 53.23%:  31%|█████████████████████████▍                                       PPL: 9.52, Acc: 53.05%:  31%|█████████████████████████▍                                       PPL: 9.50, Acc: 52.88%:  31%|█████████████████████████▍                                       PPL: 9.50, Acc: 52.88%:  31%|█████████████████████████▌                                       PPL: 9.43, Acc: 53.04%:  31%|█████████████████████████▌                                       PPL: 9.60, Acc: 52.87%:  31%|█████████████████████████▌                                       PPL: 9.60, Acc: 52.87%:  31%|█████████████████████████▊                                       PPL: 9.60, Acc: 53.02%:  31%|█████████████████████████▊                                       PPL: 9.83, Acc: 52.85%:  31%|█████████████████████████▊                                       PPL: 9.83, Acc: 52.85%:  32%|█████████████████████████▉                                       PPL: 9.96, Acc: 52.68%:  32%|█████████████████████████▉                                       PPL: 9.90, Acc: 52.83%:  32%|█████████████████████████▉                                       PPL: 9.90, Acc: 52.83%:  32%|██████████████████████████                                       PPL: 9.83, Acc: 52.98%:  32%|██████████████████████████                                       PPL: 9.80, Acc: 52.81%:  32%|██████████████████████████                                       PPL: 9.80, Acc: 52.81%:  32%|██████████████████████████▎                                      PPL: 9.80, Acc: 52.65%:  32%|██████████████████████████▎                                      PPL: 9.79, Acc: 52.48%:  32%|██████████████████████████▎                                      PPL: 9.79, Acc: 52.48%:  32%|██████████████████████████▍                                      PPL: 9.76, Acc: 52.32%:  32%|██████████████████████████▍                                      PPL: 9.95, Acc: 52.16%:  32%|██████████████████████████▍                                      PPL: 9.95, Acc: 52.16%:  32%|██████████████████████████▌                                      PPL: 10.17, Acc: 52.00%:  32%|██████████████████████████▎                                     PPL: 10.14, Acc: 51.84%:  32%|██████████████████████████▎                                     PPL: 10.14, Acc: 51.84%:  33%|██████████████████████████▍                                     PPL: 10.13, Acc: 51.68%:  33%|██████████████████████████▍                                                      | 3PPL: 10.16, Acc: 51.52%:  33%|██████████████████████████▍                                                      | 3PPL: 10.16, Acc: 51.52%:  33%|██████████████████████████▌                                                      | 3PPL: 10.09, Acc: 51.67%:  33%|██████████████████████████▌                                                      | 3PPL: 10.18, Acc: 51.52%:  33%|██████████████████████████▌                                                      | 3PPL: 10.18, Acc: 51.52%:  33%|██████████████████████████▊                                                      | 3PPL: 10.22, Acc: 51.36%:  33%|██████████████████████████▊                                                      | 3PPL: 10.16, Acc: 51.51%:  33%|██████████████████████████▊                                                      | 3PPL: 10.16, Acc: 51.51%:  33%|██████████████████████████▉                                                      | 3PPL: 10.16, Acc: 51.35%:  33%|██████████████████████████▉                                                      | 3PPL: 10.11, Acc: 51.50%:  33%|██████████████████████████▉                                                      | 3PPL: 10.11, Acc: 51.50%:  33%|███████████████████████████                                                      | 3PPL: 10.17, Acc: 51.34%:  33%|███████████████████████████                                                      | 3PPL: 10.31, Acc: 51.19%:  33%|███████████████████████████                                                      | 3PPL: 10.31, Acc: 51.19%:  34%|███████████████████████████▏                                                     | 3PPL: 10.29, Acc: 51.04%:  34%|███████████████████████████▏                                                     | 3PPL: 10.23, Acc: 51.18%:  34%|███████████████████████████▏                                                     | 3PPL: 10.23, Acc: 51.18%:  34%|███████████████████████████▍                                                     | 3PPL: 10.23, Acc: 51.03%:  34%|███████████████████████████▍                                                     | 3PPL: 10.22, Acc: 50.88%:  34%|███████████████████████████▍                                                     | 3PPL: 10.22, Acc: 50.88%:  34%|███████████████████████████▌                                                     | 3PPL: 10.27, Acc: 50.73%:  34%|███████████████████████████▌                                                     | 3PPL: 10.27, Acc: 50.58%:  34%|███████████████████████████▌                                                     | 3PPL: 10.27, Acc: 50.58%:  34%|███████████████████████████▋                                                     | 3PPL: 10.23, Acc: 50.73%:  34%|███████████████████████████▋                                                     | 3PPL: 10.32, Acc: 50.58%:  34%|███████████████████████████▋                                                     | 3PPL: 10.32, Acc: 50.58%:  34%|███████████████████████████▉                                                     | 3PPL: 10.25, Acc: 50.72%:  34%|███████████████████████████▉                                                     | 3PPL: 10.25, Acc: 50.58%:  34%|███████████████████████████▉                                                     | 3PPL: 10.25, Acc: 50.58%:  35%|████████████████████████████                                                     | 3PPL: 10.21, Acc: 50.72%:  35%|████████████████████████████                                                     | 3PPL: 10.22, Acc: 50.57%:  35%|████████████████████████████                                                     | 3PPL: 10.22, Acc: 50.57%:  35%|████████████████████████████▏                                                    | 3PPL: 10.31, Acc: 50.43%:  35%|████████████████████████████▏                                                    | 3PPL: 10.24, Acc: 50.57%:  35%|████████████████████████████▏                                                    | 3PPL: 10.24, Acc: 50.57%:  35%|████████████████████████████▍                                                    | 3PPL: 10.39, Acc: 50.43%:  35%|████████████████████████████▍                                                    | 3PPL: 10.33, Acc: 50.57%:  35%|████████████████████████████▍                                                    | 3PPL: 10.33, Acc: 50.57%:  35%|████████████████████████████▌                                                    | 3PPL: 10.37, Acc: 50.42%:  35%|████████████████████████████▌                                                    | 3PPL: 10.32, Acc: 50.56%:  35%|████████████████████████████▌                                                    | 3PPL: 10.32, Acc: 50.56%:  35%|████████████████████████████▋                                                    | 3PPL: 10.25, Acc: 50.70%:  35%|████████████████████████████▋                                                    | 3PPL: 10.25, Acc: 50.56%:  35%|████████████████████████████▋                                                    | 3PPL: 10.25, Acc: 50.56%:  36%|████████████████████████████▊                                                    | 3PPL: 10.45, Acc: 50.42%:  36%|████████████████████████████▊                                                    | 3PPL: 10.44, Acc: 50.28%:  36%|████████████████████████████▊                                                    | 3PPL: 10.44, Acc: 50.28%:  36%|█████████████████████████████                                                    | 3PPL: 10.40, Acc: 50.42%:  36%|█████████████████████████████                                                    | 3PPL: 10.34, Acc: 50.56%:  36%|█████████████████████████████                                                    | 3PPL: 10.34, Acc: 50.56%:  36%|█████████████████████████████▏                                                   | 3PPL: 10.27, Acc: 50.69%:  36%|█████████████████████████████▏                                                   | 3PPL: 10.21, Acc: 50.83%:  36%|█████████████████████████████▏                                                   | 3PPL: 10.21, Acc: 50.83%:  36%|█████████████████████████████▎                                                   | 3PPL: 10.24, Acc: 50.69%:  36%|█████████████████████████████▎                                                   | 3PPL: 10.21, Acc: 50.82%:  36%|█████████████████████████████▎                                                   | 3PPL: 10.21, Acc: 50.82%:  36%|█████████████████████████████▌                                                   | 3PPL: 10.48, Acc: 50.68%:  36%|█████████████████████████████▌                                                   | 3PPL: 10.43, Acc: 50.82%:  36%|█████████████████████████████▌                                                   | 364/999 [44:44<00PPL: 10.43, Acc: 50.82%:  37%|█████████████████████████████▋                                                   | 366/999 [44:44<00PPL: 10.41, Acc: 50.68%:  37%|█████████████████████████████▋                                                   | 366/999 [44:44<00PPL: 10.48, Acc: 50.54%:  37%|█████████████████████████████▋                                                   | 366/999 [44:44<00PPL: 10.48, Acc: 50.54%:  37%|█████████████████████████████▊                                                   | 368/999 [44:44<00PPL: 10.48, Acc: 50.41%:  37%|█████████████████████████████▊                                                   | 368/999 [44:44<00PPL: 10.88, Acc: 51.15%: 100%|█████████████████████████████████████████████████████████████████████████████████| 999/999 [45:38<00:00,  2.74s/it]
    PPL: 10.88, Acc: 51.15%, Eff.Ctx: 56.1

======================================================================
ABLATION RESULTS SUMMARY (by group)
======================================================================

--- C_head_aware_pos_mix_g ---
Name                      PPL      Acc    Eff.Ctx
--------------------------------------------------
C_ha_pos32_mix32_g508    11.98  50.35%       76.9
C_ha_pos32_mix32_g252    11.93  50.25%       54.9
C_ha_pos32_mix32_g124    11.97  50.15%       43.9
C_ha_pos32_mix32_g60    12.05  50.45%       38.4
C_ha_pos32_mix64_g508    10.70  50.65%       94.6
C_ha_pos32_mix64_g252    10.66  51.45%       72.6
C_ha_pos32_mix64_g124    10.69  51.65%       61.6
C_ha_pos32_mix64_g60    10.88  51.15%       56.1

======================================================================
ABLATION STUDY COMPLETE
======================================================================